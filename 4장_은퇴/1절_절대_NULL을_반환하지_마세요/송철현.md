# 절대 NULL을 반환하지 마세요
## 내용 정리

---
1. 객체에 대한 `신뢰(trust)` <br>

```java
public String title() {
    if(/* title이 없다면 */) {
        return null;
    }
    return "Elegant Objects";
}

String title = x.title();
print(title.length());
```

* title.length()를 호출할 때마다 항상 NullPointerException 예외가 던져질지 모른다는 사실을 염두해두어야 함 <br>
=> 이건 기술적인 불펼함일 뿐임 <br>
=> 가장 큰 문제는 `객체에 대한 신뢰`가 무너짐 <br>
=> 객체에게 작업을 요청한 후 안심하고 결과에 의지할 수 없음 <br>
=> 객체라는 사상에는 우리가 `신뢰하는` 엔티티라는 개념이 담겨져 있음 <br>

* 신뢰라는 말에는 객체가 자신의 행동을 전적으로 `책임지고(responsible)` 우리가 어떤 식으로든 간섭하지 않는다는 의미

* NULL을 사용하면 전체 소프트웨어 대한 신뢰가 크게 손상되고, 소프트웨어가 유지보수 불가능할 정도로 엉망이 될 것임

* 신뢰의 부족은 결과적으로 유지보수성의 심각한 손실로 이어짐

* 또, 객체를 실제로 사용하거나 메시지를 전송하기 전에 이 결과가 NULL이 아닌지를 중복을 체크해야 함

<br>

---
2. 빠르게 실패하기 vs. 안전하게 실패하기 <br>

* 소프트웨어 견고성(software robustness)과 실패 탄력회복성(failure resilience) 관련해서 상반되는 두 가지 철학 <br>
=> 빠르게 실패하기(fail fast)와 안전하게 실패하기(fail safe) <br>

✔️ 안전하게 실패하기

* 버그, 입출력 문제, 메모리 오버플로우 등이 발생한 상황에서도 소프트웨어가 계속 실행될 수 있도록 최대한 많은 노력을 기울일 것을 권장

* NULL을 반환하는 방법도 일종의 생존 기법

✔️ 빠르게 실패하기

* 문제가 발생하면 곧바로 실행을 중단하고 최대한 빨리 예외를 던짐, 결과에 대해서는 걱정하지 않음

* 실패를 감추는 대신 강조, 실패를 눈에 잘 띄게 만들고 추적하기 쉽게 만듬

<br>

---
3. NULL의 대안

```java
/* NULL 반환 좋지 않은 방법 */
public User user(String name) {
    if(/* 데이터베이스에서 발견하지 못했다면 */) {
        return null;
    }
    return /* 데이터베이스로부터 */;
}
```


✔️ 메서드를 나누는 방법

```java
public boolean exists(String name) {
    if(/* 데이터베이스에서 발견하지 못했다면 */) {
        return false;
    }
    return true;
}

public User user(String name) {
    return /* 데이터베이스로부터 */;
}
```

* 첫 번째 메서드는 객체의 존재를 확인하고, 두 번째 메서드는 객체를 반환, 아무 것도 찾지 못한 경우 두 번째 메서드는 예외를 던짐

* 데이터베이스에 요청을 두 번 전송하기 때문에 비효율적인 단점이 있음



✔️ 객체 컬렉션을 반환하는 방법

```java
public Collection<User> users(String name) {
    if(/* 데이터베이스에서 발견하지 못했다면 */) {
        return new ArrayList<>(0);
    }
    return Collections.singleton(/* 데이터베이스로부터 */);
}
```

* 사용자를 발견하지 못한 경우 빈 컬렉션을 반환

* 클라이언트는 객체를 추출하기 위해 어떤 식으로든 컬렉션에 접근해야만 함

* 기술적으로 이 방법은 NULL과 크게 다르지 않지만 더 깔끔함



✔️ 널 객체(null object) 디자인 패턴 방법

* 원하는 객체를 발견하지 못할 경우, 겉으로 보기에는 원래의 객체처럼 보이지만 실제로는 다르게 행동하는 객체를 반환

* 널 객체는 일부 작업은 정상적으로 처리하지만, 나머지 작업은 처리하지 않음

* 이 방법은 객체지향적인 사고방식과도 잘 어울리지만, 제한된 상황에서만 사용 가능하다는 단점이 있음

* 또, 반환된 객체의 타입을 동일하게 유지해야 한다는 사실에도 주의해야 함


> 절대 NULL을 반환하지 말자! NULL 대신 예외를 던지거나, 컬렉션을 반환하거나, 널 객체를 반환하자

<br>

## 느낀점
---

빠르게 실패하기와 안전하게 실패하기는 처음 개발하면서 오랫동안 고민했던 문제였다. 지금은 경험상 빠르게 실패하기에 동의하고 있다. null을 한번 반환하기 시작하면 여기저기 체크문이 퍼져나가기 시작한다. <br>

개인적으로 java에서도 문제겠지만 javascript에서 이런 코드를 보면 짜증이 확나기 시작한다. 오류 추적하기도 힘들지만 가독성이 정말 안 좋아진다. <br>

저의 Optional 의견은 생각하지 못했던 부분이다. 개인적으로 성능상의 이유로 잘 쓰지 않았던 Optional이지만 가독성면에서 잘 쓰이면 좋은게 Optional이라 생각한다. <br>

객체지향적이지만 않지만 적절한 상황에는 쓰는게 좋다고 본다. 결국은 유지보수를 위해서가 아니겠는가😀??
